<?xml version="1.0"?>
<metaproxy
		xmlns="http://indexdata.com/metaproxy"
		xmlns:xi="http://www.w3.org/2001/XInclude"
		version="1.0">

	<start route="start"/>

	<filters>
		<filter id="frontend" type="frontend_net">
			<threads>10</threads>
			<port>@:9000</port>
			<message>FN</message>
		</filter>

		<filter id="sru" type="sru_z3950">
			<database name="Default">
				<xi:include href="../metaproxy/etc/explain.xml"/>
			</database>
		</filter>

		<filter id="cql" type="cql_rpn">
			<conversion file="../metaproxy/etc/cql2pqf.txt"/>
		</filter>

		<filter id="retrieve" type="record_transform">
			<retrievalinfo xmlns="http://indexdata.com/yaz" version="1.0">
				<retrieval syntax="xml" name="dc" identifier="info:srw/schema/1/dc-v1.1">
					<backend syntax="usmarc" name="F">
						<marc inputformat="marc" outputformat="marcxml" inputcharset="marc-8"/>
						<xslt stylesheet="../metaproxy/xml/xslt/MARC21slim2DC.xsl"/>
					</backend>
				</retrieval>
				<retrieval syntax="opac"/>
				<retrieval syntax="xml" name="opac">
					<backend syntax="opac" name="F">
					<marc inputformat="marc" outputformat="marcxml" inputcharset="marc-8"/>
					</backend>
				</retrieval>
				<retrieval syntax="usmarc">
					<backend syntax="usmarc" name="F">
					</backend>
				</retrieval>
			</retrievalinfo>
		</filter>


		<filter id="backend" type="zoom">
			<torus url="http://usi.indexdata.com/torus2/searchable.%realm/records/?query=%query">
				<!-- these records are examples only -->
				<records>

					<!-- Solr SSGFI1 -->
					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/digreg/</zurl>
						<udb>math-digreg</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Author s=pw t=r</cclmap_au>
						<cclmap_date>1=Year</cclmap_date>
						<cclmap_id>1=PPN</cclmap_id>
					</record>

					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/jfm/</zurl>
						<udb>jfm</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Author s=pw t=r</cclmap_au>
						<cclmap_msc>1=MSC t=r</cclmap_msc>
						<cclmap_isbn>1=ISBN/ISSN t=r</cclmap_isbn>
						<cclmap_issn>1=ISBN/ISSN t=r</cclmap_issn>
						<cclmap_id>1=Number</cclmap_id>
					</record>

					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/math/</zurl>
						<udb>math-guide</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Author s=pw t=r</cclmap_au>
						<cclmap_su>1=Keywords s=pw t=r</cclmap_su>
						<cclmap_bkl>1=BK t=r</cclmap_bkl>
						<cclmap_msc>1=MSC t=r</cclmap_msc>
						<cclmap_id>1=Number</cclmap_id>
					</record>

					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/geo/</zurl>
						<udb>geo-guide</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Author s=pw t=r</cclmap_au>
						<cclmap_lang>1=Language</cclmap_lang>
						<cclmap_su>1=Keywords s=pw t=r</cclmap_su>
						<cclmap_bkl>1=BK t=r</cclmap_bkl>
						<cclmap_ddc>1=DDC t=r</cclmap_ddc>
						<cclmap_gok>1=GOK s=pw t=r</cclmap_gok>
						<cclmap_id>1=Number</cclmap_id>
					</record>

					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/his/</zurl>
						<udb>history-guide</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Author s=pw t=r</cclmap_au>
						<cclmap_lang>1=Language</cclmap_lang>
						<cclmap_su>1=Keywords s=pw t=r</cclmap_su>
						<cclmap_bkl>1=BK t=r</cclmap_bkl>
						<cclmap_ddc>1=DDC t=r</cclmap_ddc>
						<cclmap_gok>1=GOK s=pw t=r</cclmap_gok>
						<cclmap_id>1=Number</cclmap_id>
					</record>

					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/lit/</zurl>
						<udb>literature-guide</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Editor s=pw t=r</cclmap_au>
						<cclmap_lang>1=Language</cclmap_lang>
						<cclmap_su>1=Keywords s=pw t=r</cclmap_su>
						<cclmap_bkl>1=BK t=r</cclmap_bkl>
						<cclmap_ddc>1=DDC t=r</cclmap_ddc>
						<cclmap_gok>1=GOK s=pw t=r</cclmap_gok>
						<cclmap_id>1=Number</cclmap_id>
					</record>

					<record>
						<zurl>ssgfi1.sub.uni-goettingen.de:8081/solr/forst/</zurl>
						<udb>forestry-guide</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=Title s=pw t=r</cclmap_ti>
						<cclmap_au>1=Author s=pw t=r</cclmap_au>
						<cclmap_su>1=Keywords s=pw t=r</cclmap_su>
						<cclmap_id>1=Number</cclmap_id>

						<requestSyntax>xml</requestSyntax>
						<piggyback>1</piggyback>
					</record>


					<!-- Solr Harvest -->
					<record>
						<zurl>vlib.sub.uni-goettingen.de/solr/geo-leo-artikel</zurl>
						<udb>geo-leo-artikel</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=title s=pw t=r</cclmap_ti>
						<cclmap_au>1=author s=pw t=r</cclmap_au>
						<cclmap_date>1=date</cclmap_date>
						<cclmap_lang>1=language</cclmap_lang>
						<cclmap_su>1=subject s=pw t=r</cclmap_su>
						<cclmap_id>1=id</cclmap_id>
					</record>

					<record>
						<zurl>vlib.sub.uni-goettingen.de/solr/geo-leo-digitalisate</zurl>
						<udb>geo-leo-digitalisate</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=title s=pw t=r</cclmap_ti>
						<cclmap_au>1=author s=pw t=r</cclmap_au>
						<cclmap_date>1=date</cclmap_date>
						<cclmap_su>1=subject s=pw t=r</cclmap_su>
						<cclmap_id>1=id</cclmap_id>
					</record>

					<record>
						<zurl>vlib.sub.uni-goettingen.de/solr/math-arxiv</zurl>
						<udb>math-arxiv</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=title s=pw t=r</cclmap_ti>
						<cclmap_au>1=author s=pw t=r</cclmap_au>
						<cclmap_date>1=date</cclmap_date>
						<cclmap_lang>1=language</cclmap_lang>
						<cclmap_su>1=subject s=pw t=r</cclmap_su>
						<cclmap_msc>1=subject_msc s=pw t=r</cclmap_msc>
						<cclmap_id>1=id</cclmap_id>
					</record>

					<record>
						<zurl>vlib.sub.uni-goettingen.de/solr/digizeitschriften</zurl>
						<udb>digizeitschriften</udb>
						<sru>solr</sru>

						<cclmap_term>s=al t=r</cclmap_term>
						<cclmap_ti>1=title s=pw t=r</cclmap_ti>
						<cclmap_au>1=author s=pw t=r</cclmap_au>
						<cclmap_date>1=date</cclmap_date>
						<cclmap_su>1=subject s=pw t=r</cclmap_su>
						<cclmap_id>1=id</cclmap_id>
					</record>

					<!-- SRU Test -->
					<record>
						<zurl>sru.gbv.de/opac-de-7</zurl>
						<udb>opac-de-7</udb>
						<sru>get</sru>
						<sruVersion>1.1</sruVersion>
						<requestSyntax>xml</requestSyntax>
						<piggyback>1</piggyback>

						<cclmap_term>1=pica.all s=al t=r</cclmap_term>
						<cclmap_ti>1=pica.tit s=pw t=r</cclmap_ti>
						<cclmap_au>1=pica.per s=pw t=r</cclmap_au>
						<cclmap_date>1=pica.jah</cclmap_date>
						<cclmap_lang>1=pica.spr</cclmap_lang>
						<cclmap_su>1=pica.sww s=pw t=r</cclmap_su>
						<cclmap_bkl>1=pica.bkl t=r</cclmap_bkl>
						<cclmap_ddc>1=pica.ddc t=r</cclmap_ddc>
						<cclmap_msc>1=pica.msc s=pw t=r</cclmap_msc>
						<cclmap_gok>1=pica.lkl s=pw t=r</cclmap_gok>
						<cclmap_brk>1=pica.brk s=pw t=r</cclmap_brk>
						<cclmap_isbn>1=pica.isb s=pw t=r</cclmap_isbn>
						<cclmap_issn>1=pica.iss s=pw t=r</cclmap_issn>
						<cclmap_id>1=pica.ppn</cclmap_id>
					</record>

					<!-- Z39.50 Test -->
					<record>
						<zurl>sru.gbv.de/opac-de-7</zurl>
						<udb>opac-de-7Z</udb>
						<requestSyntax>xml</requestSyntax>
						<piggyback>1</piggyback>

						<cclmap_term>1=1016 s=al t=r</cclmap_term>
						<cclmap_ti>1=4 s=pw t=r</cclmap_ti>
						<cclmap_au>1=1004 s=pw t=r</cclmap_au>
						<cclmap_date>1=30</cclmap_date>
						<cclmap_lang>1=8601</cclmap_lang>
						<cclmap_su>1=46 s=pw t=r</cclmap_su>
						<cclmap_bkl>1=5004 t=r</cclmap_bkl>
						<cclmap_ddc>1=5008 t=r</cclmap_ddc>
						<cclmap_msc>1=5012 s=pw t=r</cclmap_msc>
						<cclmap_gok>1=5010 s=pw t=r</cclmap_gok>
						<cclmap_brk>1=5006 s=pw t=r</cclmap_brk>
						<cclmap_isbn>1=7 s=pw t=r</cclmap_isbn>
						<cclmap_issn>1=8 s=pw t=r</cclmap_issn>
						<cclmap_id>1=12</cclmap_id>
					</record>




				</records>
			</torus>

			<fieldmap cql="cql.serverChoice"/>
			<fieldmap cql="dc.title" ccl="ti"/>
			<fieldmap cql="dc.creator" ccl="au"/>
			<fieldmap cql="dc.date" ccl="date"/>
			<fieldmap cql="dc.language" ccl="lang"/>
			<fieldmap cql="dc.subject" ccl="su"/>
			<fieldmap cql="dc.subject.bkl" ccl="bkl"/>
			<fieldmap cql="dc.subject.ddc" ccl="ddc"/>
			<fieldmap cql="dc.subject.msc" ccl="msc"/>
			<fieldmap cql="dc.subject.gok" ccl="gok"/>
			<fieldmap cql="dc.subject.brk" ccl="brk"/>
			<fieldmap cql="bath.isbn" ccl="isbn"/>
			<fieldmap cql="bath.issn" ccl="issn"/>
			<cclmap>
				<qual name="term">
					<attr type="u" value="1016"/>
				</qual>
			</cclmap>

			<log apdu="false"/>
			<zoom timeout="20" proxy_timeout="1"/>
		</filter>

	</filters>



	<routes>
		<route id="start">
			<filter refid="frontend"/>
			<filter type="sru_z3950"/>
	<!--		<filter type="session_shared">
				<resultset ttl="0" restart="false"/>
				<session ttl="60" max="100"/>
			</filter> -->
			<filter type="log">
				<message>B</message>
				<category apdu="false" session="true"/>
			</filter>
			<filter refid="backend"/>
			<filter type="bounce"/>
		</route>
	</routes>
</metaproxy>

